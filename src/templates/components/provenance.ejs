<%##
	locals: {
		provenance: Provenance,
	}
%>

<div class="provenance">
	<%
		const withholdings = provenance.withholdings || provenance.oiaRequest?.withholdings;

		const [dateType, date] = (() => {
			if (provenance.published) {
				return ['Published', provenance.published];
			} else if (provenance.extracted) {
				return ['Extracted', provenance.extracted];
			} else if (provenance.released) {
				return ['Released', provenance.released];
			} else if (provenance.retrieved) {
				return ['Retrieved', provenance.retrieved];
			}
		})();
	%>

	<% if (provenance.method) { %>
		<div class="provenance__source">
			<% if (provenance.url) { %>
				<a
					<%- include('../helpers/href-with-target', { href: provenance.url }); %>
					class="provenance__source__link"
				><%= provenance.method %></a>
			<% } else { %>
				<%= provenance.method %>
			<% } %>
			<% if (provenance.source) { %>
				by <%= provenance.source %>
			<% } %>

			<% if (date) { %>
				<%- include('subcomponents/provenance-date', { date, dateType }); %>
			<% } %>
			<% if (withholdings) { %>
				<%- include('../components/withholdings', { withholdings }) %>
			<% } %>
		</div>
	<% } else {
		if (provenance.source) { %>
			<div class="provenance__source">Sourced from <%= provenance.source %></div>
		<% } %>

		<% if (date) { %>
			<%- include('subcomponents/provenance-date', { date, dateType }); %>
		<% } %>
		<% if (withholdings) { %>
			<%- include('../components/withholdings', { withholdings }) %>
		<% } %>
	<% } %>
</div>
